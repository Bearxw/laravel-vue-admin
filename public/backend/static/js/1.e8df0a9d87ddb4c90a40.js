webpackJsonp([1],{HzJ8:function(n,e,t){n.exports={default:t("l+I1"),__esModule:!0}},T4Xv:function(n,e,t){(n.exports=t("BkJT")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},doRQ:function(n,e,t){var i=t("T4Xv");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("8bSs")("3155ce7c",i,!0)},"l+I1":function(n,e,t){t("SXOF"),t("mxCW"),n.exports=t("o6D2")},o6D2:function(n,e,t){var i=t("fRqy"),s=t("d+Iz");n.exports=t("Rv9F").getIterator=function(n){var e=s(n);if("function"!=typeof e)throw TypeError(n+" is not iterable!");return i(e.call(n))}},tiUO:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("lC5x"),s=t.n(i),o=t("J0Oq"),r=t.n(o),a=t("aA9S"),l=t.n(a),c=t("HzJ8"),f=t.n(c),u=t("V/8j"),m={name:"system-role",data:function(){return{query:{name:"",size:10,page:1},total:0,visible:{form:!1,formLoading:!1,listLoading:!1},formType:"add",formTitle:"新增角色",editRow:"",form:{name:"",description:"",permissions:[]},roles:[],menus:[],defaultProps:{children:"children",label:"name",id:"id"}}},methods:{handleSizeChange:function(n){this.query.size=n,this.fetchList()},handleCurrentChange:function(n){this.query.page=n,this.fetchList()},handleDelete:function(n){var e=this;this.$confirm("是否删除该角色?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(u.c)(n).then(function(n){e.$message.success("删除<"+n.name+">成功"),e.fetchList()}).catch(function(n){"Not Found"===n.statusText&&(e.$message.error("角色不存在"),e.fetchList())})})},handleForm:function(){var n=this;this.$refs.form.validate().then(function(e){e&&(n.visible.formLoading=!0,n.form.permissions=n.$refs.tree.getCheckedKeys(),"add"===n.formType?Object(u.b)(n.form).then(function(e){n.fetchList(),n.$message.success("新增成功"),n.visible.form=!1,n.visible.formLoading=!1}).catch(function(e){n.visible.formLoading=!1}):Object(u.e)(n.form,n.editRow.id).then(function(e){n.fetchList(),n.$message.success("编辑成功"),n.visible.form=!1,n.$message.error(e.msg),n.visible.formLoading=!1}).catch(function(e){"Not Found"===e.statusText&&(console.log("test"),n.$message.error("角色不存在")),n.visible.formLoading=!1}))}).catch(function(){})},showEdit:function(n){Object.existAssign(this.form,n),this.editRow=n,this.form.permissions=[];var e=!0,t=!1,i=void 0;try{for(var s,o=f()(n.permissions);!(e=(s=o.next()).done);e=!0){var r=s.value;this.form.permissions.push(r.id)}}catch(n){t=!0,i=n}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}void 0!==this.$refs.tree&&this.$refs.tree.setCheckedKeys(this.form.permissions),this.visible.form=!0,this.formType="edit",this.formTitle="编辑角色"},showAdd:function(){l()(this.form,this.$options.data().form),void 0!==this.$refs.tree&&this.$refs.tree.setCheckedKeys([]),this.visible.form=!0,this.formType="add",this.formTitle="新增角色"},fetchList:function(){var n=this;this.visible.listLoading=!0,Object(u.i)(this.query).then(function(e){n.roles=e.data,n.total=e.meta.total,n.visible.listLoading=!1}).catch(function(){})}},created:function(){var n=this;return r()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.fetchList(),e.next=3,Object(u.h)();case 3:n.menus=e.sent.menus;case 4:case"end":return e.stop()}},e,n)}))()}},d={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container"},[t("el-input",{staticClass:"filter-item w-200",attrs:{size:"medium",placeholder:"权限名"},model:{value:n.query.name,callback:function(e){n.$set(n.query,"name",e)},expression:"query.name"}}),n._v(" "),t("el-button",{staticClass:"filter-item",attrs:{icon:"el-icon-search"},on:{click:n.fetchList}},[n._v("搜索")]),n._v(" "),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"roles.store",expression:"'roles.store'"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){n.showAdd()}}},[n._v("新增")])],1),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.visible.listLoading,expression:"visible.listLoading"}],attrs:{data:n.roles,border:"",stripe:""}},[t("el-table-column",{attrs:{label:"#",width:"100px"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(n.query.size*(n.query.page-1)+e.$index+1)+"\n      ")]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"description",label:"说明",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"roles.update",expression:"'roles.update'"}],attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:function(t){n.showEdit(e.row)}}},[n._v("\n          编辑\n        ")]),n._v(" "),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"roles.destroy",expression:"'roles.destroy'"}],attrs:{size:"mini",icon:"el-icon-close",type:"danger"},on:{click:function(t){n.handleDelete(e.row.id)}}},[n._v("\n          删除\n        ")])]}}])})],1),n._v(" "),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":n.query.page,"page-sizes":[10,20,30,50],"page-size":n.query.size,layout:"total, sizes, prev, pager, next, jumper",total:n.total},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}})],1),n._v(" "),t("el-dialog",{attrs:{title:n.formTitle,visible:n.visible.form,width:"800px"},on:{"update:visible":function(e){n.$set(n.visible,"form",e)},close:function(e){n.$refs.form.resetFields()}}},[t("el-form",{ref:"form",attrs:{model:n.form,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{model:{value:n.form.name,callback:function(e){n.$set(n.form,"name",e)},expression:"form.name"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"说明",prop:"description",verify:"",required:""}},[t("el-input",{model:{value:n.form.description,callback:function(e){n.$set(n.form,"description",e)},expression:"form.description"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"权限"}},[t("el-tree",{ref:"tree",attrs:{data:n.menus,"show-checkbox":"","node-key":"id","default-checked-keys":n.form.permissions,props:n.defaultProps}})],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){n.visible.form=!1}}},[n._v("取 消")]),n._v(" "),t("el-button",{attrs:{type:"primary",loading:n.visible.formLoading},on:{click:n.handleForm}},[n._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=t("/Xao")(m,d,!1,function(n){t("doRQ")},"data-v-13eebd45",null);e.default=p.exports}});