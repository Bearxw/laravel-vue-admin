webpackJsonp([0],{HzJ8:function(n,e,t){n.exports={default:t("l+I1"),__esModule:!0}},WFUW:function(n,e,t){var i=t("YwF1");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("8bSs")("299bd356",i,!0)},YwF1:function(n,e,t){(n.exports=t("BkJT")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},"l+I1":function(n,e,t){t("SXOF"),t("mxCW"),n.exports=t("o6D2")},o6D2:function(n,e,t){var i=t("fRqy"),s=t("d+Iz");n.exports=t("Rv9F").getIterator=function(n){var e=s(n);if("function"!=typeof e)throw TypeError(n+" is not iterable!");return i(e.call(n))}},slvS:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("aA9S"),s=t.n(i),o=t("HzJ8"),r=t.n(o),a=t("V/8j"),l={name:"system-admin",data:function(){return{query:{name:"",size:10,page:1},total:0,visible:{form:!1,formLoading:!1,listLoading:!1},formType:"add",formTitle:"新增角色",editRow:"",form:{username:"",password:"",roles:[],status:0},admins:[],roles:[]}},methods:{rolesToString:function(n){return n.reduce(function(n,e,t){return 0===t?e.name:e.name+"，"+n},"")},handleSizeChange:function(n){this.query.size=n,this.fetchList()},handleCurrentChange:function(n){this.query.page=n,this.fetchList()},handleForm:function(){var n=this;this.$refs.form.validate().then(function(e){e&&(n.visible.formLoading=!0,"add"===n.formType?Object(a.a)(n.form).then(function(e){n.fetchList(),n.visible.form=!1,n.$message.success("新增成功"),n.visible.formLoading=!1}).catch(function(e){"Not Found"===e.statusText&&(n.$message.error("管理员不存在"),n.fetchList()),n.visible.formLoading=!1}):Object(a.d)(n.form,n.editRow.id).then(function(e){n.fetchList(),n.$message.success("编辑成功"),n.visible.form=!1,n.visible.formLoading=!1}).catch(function(e){"Not Found"===e.statusText&&(n.$message.error("管理员不存在"),n.fetchList()),n.visible.formLoading=!1}))}).catch(function(){})},showEdit:function(n){Object.existAssign(this.form,n),this.editRow=n,this.form.roles=[];var e=!0,t=!1,i=void 0;try{for(var s,o=r()(n.roles);!(e=(s=o.next()).done);e=!0){var a=s.value;this.form.roles.push(a.id)}}catch(n){t=!0,i=n}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}this.visible.form=!0,this.formType="edit",this.formTitle="编辑管理员"},showAdd:function(){s()(this.form,this.$options.data().form),this.visible.form=!0,this.formType="add",this.formTitle="新增管理员"},fetchList:function(){var n=this;this.visible.listLoading=!0,Object(a.g)(this.query).then(function(e){n.admins=e.data,n.total=e.meta.total,n.visible.listLoading=!1})}},created:function(){var n=this;this.fetchList(),this.$fetchData(["roles"]).then(function(e){n.roles=e.roles})}},c={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container"},[t("el-input",{staticClass:"filter-item w-200",attrs:{size:"medium",placeholder:"用户名"},model:{value:n.query.name,callback:function(e){n.$set(n.query,"name",e)},expression:"query.name"}}),n._v(" "),t("el-button",{staticClass:"filter-item",attrs:{icon:"el-icon-search"},on:{click:n.fetchList}},[n._v("搜索")]),n._v(" "),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"admins.store",expression:"'admins.store'"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){n.showAdd()}}},[n._v("新增")])],1),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.visible.listLoading,expression:"visible.listLoading"}],attrs:{data:n.admins,border:"",stripe:""}},[t("el-table-column",{attrs:{label:"#",width:"100px"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(n.query.size*(n.query.page-1)+e.$index+1)+"\n      ")]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"username",label:"账号",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(1===e.row.status?"启用":"禁用")+"\n      ")]}}])}),n._v(" "),t("el-table-column",{attrs:{label:"权限组",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(n.rolesToString(e.row.roles))+"\n      ")]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"last_login_time",label:"最后登陆时间",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"admins.update",expression:"'admins.update'"}],attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:function(t){n.showEdit(e.row)}}},[n._v("\n          编辑\n        ")])]}}])})],1),n._v(" "),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":n.query.page,"page-sizes":[10,20,30,50],"page-size":n.query.size,layout:"total, sizes, prev, pager, next, jumper",total:n.total},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}})],1),n._v(" "),t("el-dialog",{attrs:{title:n.formTitle,visible:n.visible.form,width:"600px"},on:{"update:visible":function(e){n.$set(n.visible,"form",e)},close:function(e){n.$refs.form.resetFields()}}},[t("el-form",{ref:"form",attrs:{model:n.form,"label-width":"100px"}},["add"===n.formType?t("el-form-item",{attrs:{label:"账户名",prop:"username",verify:"",required:""}},[t("el-input",{model:{value:n.form.username,callback:function(e){n.$set(n.form,"username",e)},expression:"form.username"}})],1):n._e(),n._v(" "),"add"===n.formType?t("el-form-item",{attrs:{label:"密码",prop:"password",verify:"",required:""}},[t("el-input",{model:{value:n.form.password,callback:function(e){n.$set(n.form,"password",e)},expression:"form.password"}})],1):n._e(),n._v(" "),t("el-form-item",{attrs:{label:"状态",prop:"status",verify:"",required:""}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},model:{value:n.form.status,callback:function(e){n.$set(n.form,"status",e)},expression:"form.status"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"权限角色",prop:"roles"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:n.form.roles,callback:function(e){n.$set(n.form,"roles",e)},expression:"form.roles"}},n._l(n.roles,function(n){return t("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})}))],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){n.visible.form=!1}}},[n._v("取 消")]),n._v(" "),t("el-button",{attrs:{type:"primary",loading:n.visible.formLoading},on:{click:n.handleForm}},[n._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var f=t("/Xao")(l,c,!1,function(n){t("WFUW")},"data-v-730f4f8a",null);e.default=f.exports}});